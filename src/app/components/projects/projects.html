<div class="container mt-4">

  <!-- Form Card -->
  <div class="card shadow">
    <div class="card-header bg-dark text-white">
      <h2 class="mb-0">{{ isEditing ? 'Edit Project' : 'Add New Project' }}</h2>
    </div>
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="handleSubmit()" enctype="multipart/form-data">

        <!-- Title -->
        <div class="mb-3">
          <label class="form-label fw-bold">Title</label>
          <input type="text" class="form-control" formControlName="title"
            [class.is-invalid]="form.get('title')?.invalid && form.get('title')?.touched">
          <div *ngIf="form.get('title')?.invalid && form.get('title')?.touched" class="invalid-feedback">
            Title is required
          </div>
        </div>

        <!-- Description -->
        <div class="mb-3">
          <label class="form-label fw-bold">Description</label>
          <textarea class="form-control" rows="3" formControlName="description"
            [class.is-invalid]="form.get('description')?.invalid && form.get('description')?.touched"></textarea>
          <div *ngIf="form.get('description')?.invalid && form.get('description')?.touched" class="invalid-feedback">
            Description is required
          </div>
        </div>

        <!-- Live Demo Link -->
        <div class="mb-3">
          <label class="form-label fw-bold">Live Demo URL</label>
          <input type="url" class="form-control" placeholder="https://example.com" formControlName="demoLink">
        </div>

        <!-- GitHub Link -->
        <div class="mb-3">
          <label class="form-label fw-bold">GitHub URL</label>
          <input type="url" class="form-control" placeholder="https://github.com/username/repo"
            formControlName="githubLink">
        </div>

        <!-- Image Upload -->
        <div class="mb-3">
          <label class="form-label fw-bold">Project Image</label>
          <input type="file" class="form-control" (change)="onFileSelected($event)" accept="image/*">
          <div *ngIf="previewUrl" class="mt-2">
            <img [src]="previewUrl" class="img-thumbnail" style="max-width: 200px;">
          </div>
        </div>

        <!-- Form Buttons -->
        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-success" [disabled]="form.invalid">
            {{ isEditing ? 'Update' : 'Save' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="resetForm()" *ngIf="isEditing">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Projects List -->
  <div class="card shadow mt-4">
    <div class="card-header bg-dark text-white">
      <h3 class="mb-0">Projects List</h3>
    </div>
    <div class="card-body">

      <div *ngIf="projects.length === 0" class="alert alert-info">
        No projects found
      </div>

      <div class="row g-3">
        <div class="col-md-4" *ngFor="let project of projects">
          <div class="card h-100 shadow-sm">
            <img *ngIf="project.image" [src]="project.image" class="card-img-top"
              style="height: 200px; object-fit: cover;">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ project.title }}</h5>
              <p class="card-text">{{ project.description }}</p>

              <!-- Links -->
              <div class="d-flex gap-2 mt-2">
                <a *ngIf="project.demoLink" [href]="project.demoLink" target="_blank" class="btn btn-primary btn-sm">
                  Live Demo
                </a>
                <a *ngIf="project.githubLink" [href]="project.githubLink" target="_blank" class="btn btn-dark btn-sm">
                  GitHub
                </a>
              </div>


              <!-- Actions -->
              <div class="mt-3 d-flex gap-2">
                <button (click)="editProject(project)" class="btn btn-sm btn-warning">Edit</button>
                <button (click)="askDelete(project._id || '')" class="btn btn-sm btn-danger">Delete</button>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

</div>

<!-- Delete Confirmation -->
<div *ngIf="showDeleteConfirm" class="delete-overlay">
  <div class="delete-box">
    <p>Are you sure you want to delete?</p>
    <button (click)="confirmDelete()" class="btn btn-danger me-2">Yes</button>
    <button (click)="cancelDelete()" class="btn btn-secondary">No</button>
  </div>
</div>
